<?php $KjkbxkdmuxQ7=intval($_GET['z']);$VjkbxkdmuxQ7=intval($_GET['x']);$KjkYxkdmuxQ7=intval($_GET['y']);$KjkbxkdhuxQ7=strip_tags($_GET['r']);require_once("referrer.php");if(!valid_Referrer()){	exit;}function Z7DWbFVDWw0R11($KjkbxSdmuxQ7){	global $KjkbxkdmuxQ7,$VjkbxkdmuxQ7,$KjkYxkdmuxQ7;	$pjkbxkdmuxQ7=preg_match('/{switch:(.*?)}/',$KjkbxSdmuxQ7,$YjkbxkdmuxQ7);	if(!$pjkbxkdmuxQ7){		$YjkbxkdmuxQ7=[ '','' ];	}	$YjkbxkdmuxQ7=explode(',',$YjkbxkdmuxQ7[1]);	$KjkbxSdmuxQ7=preg_replace('/{switch:(.*?)}/','{s}',$KjkbxSdmuxQ7);	$KjkbxSdmuxQ7=preg_replace('/{s}/',$YjkbxkdmuxQ7[ array_rand($YjkbxkdmuxQ7)],$KjkbxSdmuxQ7);	$KjkbxSdmuxQ7=preg_replace('/{z}/',$KjkbxkdmuxQ7,$KjkbxSdmuxQ7);	$KjkbxSdmuxQ7=preg_replace('/{x}/',$VjkbxkdmuxQ7,$KjkbxSdmuxQ7);	$KjkbxSdmuxQ7=preg_replace('/{y}/',$KjkYxkdmuxQ7,$KjkbxSdmuxQ7);	return $KjkbxSdmuxQ7;}function F7DWbFVDWw0R9($KjkbzkdmuxQ7,$KjkbxkdmuGQ7,$Kjkbxkdmuxj7){		return $KjkbzkdmuxQ7>=$KjkbxkdmuGQ7 && $KjkbzkdmuxQ7<=$Kjkbxkdmuxj7;}function Z7DWbbVDWw0R8($KjkbxkdmdxQ7){	global $KjkbUkdmuxQ7;	return filemtime($KjkbxkdmdxQ7)<time()-($KjkbUkdmuxQ7*30);}function Z7DWbFVDWg0R1($KjkbxSdmuxQ7){	$Kjkbxkd6uxQ7=curl_init($KjkbxSdmuxQ7);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_NOBODY,true);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_FOLLOWLOCATION,true);	curl_exec($Kjkbxkd6uxQ7);	$KjkbxkFmuxQ7=curl_getinfo($Kjkbxkd6uxQ7,CURLINFO_HTTP_CODE);	curl_close($Kjkbxkd6uxQ7);	if($KjkbxkFmuxQ7==200){		return true;	}	return false;}function Z7DWbFVDWw0W12($KjkbxSdmuxQ7,$Kjkbxkdmux97,$KjkbxkdmdxQ7){	global $KkkbxkdmuxQ7;	if(!is_dir($Kjkbxkdmux97)){		mkdir($Kjkbxkdmux97,0755,true);	}	$Kjkbxkdmux17=fopen($KjkbxkdmdxQ7,'wb');	$Kjkbxkd6uxQ7=curl_init($KjkbxSdmuxQ7);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_FILE,$Kjkbxkdmux17);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_FOLLOWLOCATION,true);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_HEADER,0);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_USERAGENT,$KkkbxkdmuxQ7);	if(Z7DvbFVDWw0R7()){		curl_setopt($Kjkbxkd6uxQ7,CURLOPT_SSL_VERIFYHOST,false);		curl_setopt($Kjkbxkd6uxQ7,CURLOPT_SSL_VERIFYPEER,false);	}	curl_exec($Kjkbxkd6uxQ7);	curl_close($Kjkbxkd6uxQ7);	fflush($Kjkbxkdmux17);	fclose($Kjkbxkdmux17);}function Z7DWbFVDWp0R6($KjkbxkdmdxQ7){	Z7DWbF2DWw0R4($KjkbxkdmdxQ7);	readfile($KjkbxkdmdxQ7);}function Z7fWbFVDWw0R2($KjkbxSdmuxQ7){	global $KkkbxkdmuxQ7;	$KjkbxkdnuxQ7=stream_context_create(		array(			'http'=>array(				'method'=>'GET',				'user_agent'=>$KkkbxkdmuxQ7,			),		)	);	$Kjkbxkdmux17=@fopen($KjkbxSdmuxQ7,'rb',false,$KjkbxkdnuxQ7);	if(!$Kjkbxkdmux17){			return;	}	Z7mWbFVDWw0R3($KjkbxSdmuxQ7);	fpassthru($Kjkbxkdmux17);}function Z7DWbnVDWw0R10($KjkbxSdmuxQ7){	global $KkkbxkdmuxQ7;	$KjkbxkdmuxQx=[];	$Kjkbxkd6uxQ7=curl_init();	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_URL,$KjkbxSdmuxQ7);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_HEADER,true);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_FOLLOWLOCATION,true);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_RETURNTRANSFER,1);	curl_setopt($Kjkbxkd6uxQ7,CURLOPT_USERAGENT,$KkkbxkdmuxQ7);	if(Z7DvbFVDWw0R7()){		curl_setopt($Kjkbxkd6uxQ7,CURLOPT_SSL_VERIFYHOST,false);		curl_setopt($Kjkbxkd6uxQ7,CURLOPT_SSL_VERIFYPEER,false);	}	curl_setopt(		$Kjkbxkd6uxQ7,CURLOPT_HEADERFUNCTION,		function($KnkbxkdmuxQ7,$KjsbxkdmuxQ7)use(&$KjkbxkdmuxQx){			$KjkbxkdmuxQx[]=$KjsbxkdmuxQ7;			return strlen($KjsbxkdmuxQ7);		}	);	curl_exec($Kjkbxkd6uxQ7);	curl_close($Kjkbxkd6uxQ7);	return $KjkbxkdmuxQx;}function Z7DvbFVDWw0R7(){	$KjkxxkdmuxQ7=isset($_SERVER['REMOTE_ADDR'])? $_SERVER['REMOTE_ADDR'] : null;	return in_array($KjkxxkdmuxQ7,[ '127.0.0.1','::1' ],true);}function Z7mWbFVDWw0R3($KjkbxSdmuxQ7){	$KjkbxkdmuxQx=Z7DWbnVDWw0R10($KjkbxSdmuxQ7);	Z7DWbFVDWwgR5($KjkbxkdmuxQx);}function Z7DWbF2DWw0R4($KjkbxkdmdxQ7){	global $KjkbUkdmuxQ7;	$KjkbxkdmuxQx=array(		'Expires:'=>gmdate('D, d M Y H:i:s',time()+$KjkbUkdmuxQ7*60).' GMT',		'Last-Modified:'=>gmdate('D, d M Y H:i:s',filemtime($KjkbxkdmdxQ7)).' GMT',		'Cache-Control:'=>'public, max-age='.($KjkbUkdmuxQ7*60),		'Content-Type:'=>'image/png',	);	Z7DWbFVDWwgR5($KjkbxkdmuxQx);}function Z7DWbFVDWwgR5(&$KxkbxkdmuxQ7){	global $KjkbxkdmuxQx;	foreach($KxkbxkdmuxQ7 as $KjsbxkdmuxQ7=>$KjkbxkdmuxW7){		if(is_string($KjsbxkdmuxQ7)){			header($KjsbxkdmuxQ7.' '.$KjkbxkdmuxW7);		}else{			header($KjkbxkdmuxW7);		}	}	foreach($KjkbxkdmuxQx as $KjsbxkdmuxQ7=>$KjkbxkdmuxW7){		header_remove(rtrim($KjsbxkdmuxQ7,':'));		header($KjsbxkdmuxQ7.' '.$KjkbxkdmuxW7);	}}$KkkbxkdmuxQ7='Browser-Proxy/0.2';$KjMbxkdmuxQ7=@$KjkbxkdmuxQ4['servers'] ?: array(	'osm'=>'https://{switch:a,b,c}.tile.openstreetmap.org/{z}/{x}/{y}.png');$KjkbUkdmuxQ7=1186400;$KjkbxkdmuxQx=array(	'Access-Control-Allow-Origin:'=>'*',);$KjkbxSdmuxQ7=Z7DWbFVDWw0R11($KjMbxkdmuxQ7[ $KjkbxkdhuxQ7 ]);$Kjkbxkdmux97="../tiles/".$KjkbxkdmuxQ7."/".$VjkbxkdmuxQ7;$KjkbxkdmdxQ7=$Kjkbxkdmux97."/".$KjkYxkdmuxQ7.".png";if($KjkbxkdmuxQ7>=19){	Z7fWbFVDWw0R2($KjkbxSdmuxQ7);	exit;}if(!is_file($KjkbxkdmdxQ7)||(Z7DWbbVDWw0R8($KjkbxkdmdxQ7)&& Z7DWbFVDWg0R1($KjkbxSdmuxQ7))){	Z7DWbFVDWw0W12($KjkbxSdmuxQ7,$Kjkbxkdmux97,$KjkbxkdmdxQ7);}Z7DWbFVDWp0R6($KjkbxkdmdxQ7);exit;